# ZMap: Engineering Internet-wide network scanning at gigabit speeds

**ZMap transforms Internet measurement from a months-long endeavor into a 45-minute operation.** Developed at the University of Michigan in 2013 by Zakir Durumeric, Eric Wustrow, and J. Alex Halderman, this open-source network scanner can probe the entire IPv4 address space in under 45 minutes at gigabit speeds or under 5 minutes at 10 gigabit speeds. This represents a 1,300-fold performance improvement over Nmap, enabling researchers to conduct comprehensive Internet-wide security studies that were previously impossible due to time and resource constraints. The tool has powered over 500 academic papers, spawned an ecosystem of complementary tools, and now accounts for 33% of all Internet-wide scanning traffic as of 2024. ZMap achieves this through stateless scanning architecture, mathematically rigorous address randomization, optimized packet generation bypassing the kernel TCP/IP stack, and asynchronous send/receive operations that reach 97-98% of theoretical network capacity.

## The architectural revolution behind ZMap's unprecedented speed

ZMap achieves speeds approximately **1,300 times faster than Nmap** through four fundamental architectural innovations that completely reimagine the network scanning problem. The tool's stateless design eliminates per-connection state tracking entirely, encoding validation information directly into probe packets using UMAC-based authentication similar to SYN cookies. While Nmap maintains state for each connection with adaptive timeouts and retransmission logic, ZMap sends a single probe per target and accepts valid responses at any point during the scan, relying on a fixed 8-second cooldown period after transmission completes to capture 99.9% of responses.

Address generation uses cyclic multiplicative groups to create random permutations of the IPv4 address space. The implementation iterates over the multiplicative group (Z/pZ)× where p = 2³² + 15 (the smallest prime larger than 2³²). Each scan selects a primitive root as a generator, and the sequence a(i+1) = g × a(i) mod p produces a complete, random permutation of all IPv4 addresses. This mathematical approach requires storing only three integers: the primitive root g, the first address a₀, and the current address a(i). This elegant solution eliminates the need to store lists of addresses while ensuring even distribution across the address space, preventing network saturation of any single subnet.

Packet generation and transmission bypass the kernel's TCP/IP stack entirely. ZMap generates Ethernet frames directly using raw sockets, pre-caching static packet content and updating only host-specific fields for each probe. This eliminates per-packet routing lookups, ARP cache checks, and netfilter processing. For 10 gigabit performance, the implementation uses PF_RING Zero Copy (ZC) to provide direct userspace access to the network interface card, eliminating context switches entirely. Multiple packet creation threads operate on sharded address spaces, each maintaining independent multiplicative group generators with no mutex locks required.

The asynchronous architecture separates sending and receiving into independent threads with minimal shared state. The sending thread operates in a tight loop generating and transmitting packets at maximum NIC capacity, while the receiving thread independently captures and validates responses using libpcap. A monitor thread tracks progress and statistics. This design allows continuous operation with no inter-thread communication overhead during active scanning, and the lack of synchronization between components proves critical for achieving near-theoretical line speeds.

## Understanding what happens when you run 'zmap' with minimal configuration

When executing ZMap with minimal arguments like `zmap -p 80`, the tool applies a carefully chosen set of defaults optimized for safe, efficient scanning. **The default scan rate is 10,000 packets per second**, a conservative value balancing speed with network safety, though the tool can reach 1.44 million packets per second (full gigabit speed) when configured with `-r 0` or an explicit bandwidth limit via `-B 1G`. The default target range is 0.0.0/8, essentially a test range rather than the entire Internet, requiring explicit specification of target addresses for production scans.

The default probe module is tcp_synscan, implementing TCP SYN scanning (half-open scanning) using Windows-style TCP options that create 66-byte packets. Source port validation is enabled by default for TCP modules, encoding cryptographic validation information in the source port and initial sequence number fields. When a host responds with a SYN-ACK, the Linux kernel automatically sends a TCP RST to close the connection without additional ZMap intervention, completing the three-packet exchange (SYN, SYN-ACK, RST for open ports) or two-packet exchange (SYN, RST for closed ports).

Output defaults to CSV format directed to stdout, with an implicit filter of `success=1 && repeat=0` applied to exclude failed probes and duplicate responses. The output contains only the source IP address (saddr field) of responsive hosts unless additional fields are specified with `-f`. Deduplication uses a sliding window method tracking the last 1 million responses, providing reasonable accuracy without the ~500MB memory requirement of full deduplication. The tool automatically detects the optimal number of sender threads as min(4, CPU cores - 1), and uses a fixed 8-second cooldown period after transmission completes to capture late-arriving responses.

Blacklist processing loads `/etc/zmap/blocklist.conf` by default if it exists, excluding RFC 1918 private addresses, multicast ranges, and IANA reserved space. The address generation algorithm produces a fresh random permutation for each scan by selecting a random primitive root, ensuring addresses are probed in pseudorandom order. Status updates print to stderr every second showing send rate, receive rate, hit rate, and estimated completion time. The combination of these defaults enables immediate use while maintaining network safety and providing reasonable performance for exploratory scans.

## Comprehensive command-line options and configuration capabilities

ZMap provides exhaustive configuration through command-line flags, configuration files, and environment variables. **Target specification** accepts IP addresses, DNS hostnames, or CIDR blocks, with `-p` or `--target-ports` specifying single ports, comma-separated lists (80,443,8080), ranges (1000-2000), or `*` for all ports including port 0. The `-b` or `--blocklist-file` flag loads exclusion lists in CIDR notation, while `-w` or `--allowlist-file` specifies inclusive target lists. For scanning more than 10 million discrete addresses, `-I` or `--list-of-ips-file` provides optimized handling of individual IP lists.

Rate control supports both packet-per-second limits via `-r` or `--rate` (supporting values from 1 to theoretical maximum, with 0 meaning unlimited) and bandwidth limits via `-B` or `--bandwidth` with suffixes like 10M or 1G, where the bandwidth flag overrides the rate flag. Scan duration can be constrained with `-n` or `--max-targets` (accepting absolute numbers or percentages like 0.1%), `-N` or `--max-results` to exit after receiving a specified number of responses, and `-t` or `--max-runtime` for time-based limits. The cooldown period adjusts with `-c` or `--cooldown-time`, defaulting to 8 seconds but configurable for networks with higher latency.

Probe configuration uses `-M` or `--probe-module` to select scanning types: **tcp_synscan** (default, with probe arguments for OS fingerprinting: smallest-probes, bsd, windows, linux), **tcp_synackscan** for firewall detection, **icmp_echoscan** for ping sweeps, **icmp_echo_time** for RTT measurement, and **udp** with flexible payload specification via text:, hex:, file:, or template: arguments supporting dynamic field substitution (${SADDR}, ${DADDR}, ${SPORT}, ${DPORT}, ${RAND_BYTE}, etc.). Additional specialized modules include ntp, dns, upnp, and bacnet for protocol-specific scanning.

Output configuration through `-O` or `--output-module` supports csv (default), json (requires compilation flag), and extensible custom modules. Field selection via `-f` or `--output-fields` accepts comma-separated lists of available fields like saddr, daddr, sport, dport, seqnum, acknum, window, ttl, classification, timestamp_str, with `--list-output-fields` displaying all fields for the selected probe module. Output filtering uses SQL-like syntax with `--output-filter`, supporting integer comparisons (=, !=, <, >, <=, >=), string comparisons (=, !=), and logical operators (&&, ||) with parentheses for grouping, enabling filters like `success=1 && repeat=0 && cooldown=0` or `(classification=rst && ttl>10) || classification=synack`.

Advanced options include **sharding** for distributed scanning with `--shards=N` and `--shard=n` (requires consistent `--seed` across instances), network configuration via `-S` or `--source-ip`, `-s` or `--source-port`, `-G` or `--gateway-mac`, `--source-mac`, and `-i` or `--interface`, threading control with `-T` or `--sender-threads` and `--cores` for explicit core binding, deduplication strategy selection via `--dedup-method` (full, window, none) with `--dedup-window-size`, and comprehensive logging through `-v` or `--verbosity` (0-5), `-l` or `--log-file`, `-m` or `--metadata-file` for JSON scan metadata, and `-u` or `--status-updates-file` for CSV progress tracking.

## Real-world performance characteristics and empirical benchmarks

ZMap achieves **1.44 million packets per second at gigabit speeds**, representing 97-98% of the theoretical maximum of 1.488 Mpps for 64-byte packets on gigabit Ethernet. This translates to scanning the entire public IPv4 address space (approximately 3.7 billion addresses after blacklisting) in 42-45 minutes on a single commodity machine with standard office network connectivity. The 10 gigabit optimizations documented in the "Zippier ZMap" paper achieved 14.23 million packets per second (96% of theoretical 10 GigE maximum), completing a full IPv4 scan in 4 minutes 29 seconds. These performance levels required only 200 CPU cycles per probe at a 3 GHz clock rate, with every operation carefully optimized since an L2 cache miss alone costs approximately 100 cycles.

Hardware requirements scale with target performance. **Gigabit scanning** requires only a modern multi-core processor (1-4 cores sufficient), 512 MB minimum memory, and any standard gigabit Ethernet NIC, achievable on standard desktop computers or Ubuntu VMs with wired connections. The original University of Michigan deployment used an HP ProLiant DL120 G7 with Xeon E3-1230 3.2 GHz processor and 4GB RAM connected to standard office infrastructure. **10 gigabit scanning** demands more substantial resources: dual Intel Xeon E5-2690 processors (16 cores), 128 GB RAM, Intel X540-AT2 10 GigE controller with PF_RING-aware drivers, and well-provisioned upstream bandwidth with aggregated uplinks. The optimal thread configuration uses one packet creation thread per physical CPU core (typically 5 threads), plus single send thread, receive thread, and monitor thread.

Benchmark comparisons demonstrate dramatic performance advantages. Testing against 1 million hosts on TCP port 443 showed ZMap completing the scan in approximately 10 seconds with 98.7% coverage, while Nmap with insane timing (-T5) and maximum 2 probes required 45 minutes with 97.8% coverage, and Nmap with single probe took 24 minutes with only 81.4% coverage. Extrapolating to full IPv4 space, ZMap would require approximately 70 minutes while Nmap would need 62.5 days with optimized settings or over 116 days with retries enabled. Compared to Masscan, another high-speed scanner claiming 25 Mpps across dual 10 GigE adapters, ZMap achieved 14.1 Mpps (94.6% of line rate) on single 10 GigE while Masscan reached only 7.4 Mpps (49.6%) with two receive-side scaling queues on equivalent hardware.

Performance scales linearly with network bandwidth up to approximately 4 million packets per second, above which hit rate begins degrading due to network congestion rather than ZMap processing limitations. At 1.44 Mpps, normalized hit rate remains at 1.00 (100%), while at 3 Mpps it measures 0.99, at 4 Mpps it drops to 0.97, and at 14.23 Mpps it falls to 0.63 (63%). Analysis of response packet retransmissions at high speeds indicates upstream network congestion causing probe packet drops rather than ZMap bottlenecks. The address generation sharding optimization improved throughput by 68%, from 1.07 Gbps average to 1.80 Gbps average, by parallelizing the expensive modulo operation across multiple cores without requiring mutex locks.

## Technical comparisons reveal distinct optimization strategies and use cases

ZMap, Nmap, and Masscan each optimize for fundamentally different scanning scenarios. **ZMap excels at horizontal scanning** (many hosts, single port) through stateless architecture, single-probe methodology, and optimizations for maximum throughput, achieving 1,300x speedup over Nmap for Internet-wide surveys. **Nmap optimizes for vertical scanning** (few hosts, many ports) with stateful connection tracking, comprehensive service detection via 600+ NSE scripts, OS fingerprinting, adaptive retransmission, and detailed vulnerability assessment, making it the gold standard for targeted network audits despite requiring over a year to scan the complete Internet. **Masscan bridges both approaches** with custom TCP/IP stack enabling 10 million packets per second theoretical maximum, multi-port scanning at high speed, and built-in banner grabbing, though with less mature ecosystem and poorer address randomization statistical properties.

Methodological differences drive these performance characteristics. ZMap maintains zero per-connection state, encoding validation via UMAC in mutable packet fields (source port and sequence number for TCP), and accepts valid responses throughout the entire scan duration with fixed 8-second cooldown. Nmap tracks each connection with adaptive timeouts starting at 250ms and increasing to 300ms during scans, implements retransmission logic for reliability, and maintains state for service version detection and script execution. ZMap uses cryptographically secure cyclic multiplicative groups for address randomization (suitable for statistical sampling), while Masscan employs cheaper Feistel networks that produce clustered addresses unsuitable for valid sampling but faster for comprehensive scanning.

Coverage and accuracy trade-offs reflect different design priorities. ZMap achieves 98% coverage with single probe per target, accepting 2% packet loss as reasonable for research applications, and finds MORE responsive hosts than Nmap due to longer effective timeout windows (responses accepted throughout entire scan vs. Nmap's 250-600ms initial timeouts). Nmap achieves 98-99% coverage through retries but requires dramatically longer scan times, with "insane" timing mode capturing only 85-93% of hosts that eventually respond in ZMap's longer acceptance window. Masscan provides coverage similar to ZMap with single probes but exhibits higher packet drop rates due to less sophisticated address randomization overwhelming target networks.

Feature comparisons reveal complementary capabilities. **Service detection**: ZMap provides none (requires ZGrab for application-layer data), Nmap offers comprehensive built-in detection via NSE, Masscan includes limited banner grabbing. **Scripting**: ZMap has modular probe/output system but no scripting engine, Nmap features 600+ NSE scripts for vulnerability detection and exploitation, Masscan lacks scripting. **Protocol support**: ZMap offers TCP SYN, ICMP, UDP via probe modules, Nmap supports TCP, UDP, SCTP with multiple scan types (SYN, ACK, FIN, XMAS, NULL, etc.), Masscan focuses primarily on TCP SYN. **Memory footprint**: ZMap uses ~500MB for full deduplication or minimal memory with window method, Nmap varies with target count and script execution, Masscan maintains minimal footprint through stateless design. The optimal approach combines tools: ZMap for rapid initial discovery, Masscan for broader port enumeration when needed, Nmap for detailed analysis of interesting targets, and ZGrab2/LZR for application-layer interrogation.

## Novel technical innovations that redefined network scanning capabilities

ZMap introduced **cyclic multiplicative groups for address permutation**, solving the dual challenges of generating random address orderings without storing address lists while ensuring statistical validity for sampling. The implementation uses the multiplicative group (Z/pZ)× modulo p where p = 2³² + 15, the smallest prime exceeding 2³². Since p is prime, the group is guaranteed to be cyclic, and selecting any primitive root g as generator produces the sequence a(i+1) = g × a(i) mod p that visits every IPv4 address exactly once per cycle (excluding 0.0.0.0, which is IANA reserved). Primitive root generation utilizes the isomorphism between additive and multiplicative groups, mapping roots via f(x) = nˣ, with 3 serving as a known primitive root. Each scan randomly selects from approximately 10⁹ available generators, requiring expected 4 attempts to find one by checking coprimality with p-1 using precalculated factorization.

This mathematical foundation contrasts sharply with Masscan's Feistel network approach, which runs faster but produces poorly randomized addresses with clustering effects unsuitable for statistical sampling. ZMap's method ensures addresses are truly randomly distributed across time and space, preventing network saturation while supporting valid inferential statistics. At full gigabit speed (1.37 Mpps), a /24 network receives one packet every 10.6 seconds (3.8 bytes/second), a /16 every 40 milliseconds (1,000 bytes/second), and a /8 every 161 microseconds (250,000 bytes/second), distributing load safely across the Internet.

Stateless scanning via SYN cookie-inspired validation enables ZMap's scalability. For each target, the scanner computes a Message Authentication Code (MAC) of the destination address using UMAC (Universal Message Authentication Code) with a scan-specific secret generated at initialization. UMAC was selected for performance guarantees, authenticating approximately an order of magnitude faster than HMAC-SHA1 and about 2x faster than MMH. The MAC value spreads across available mutable packet fields: source port and initial sequence number for TCP SYN scans, ICMP identifier and sequence number for ICMP scans. Upon receiving responses, the validation component recomputes the expected MAC from the destination address and compares against response fields, discarding mismatches. This cryptographic approach distinguishes valid scan responses from background traffic without maintaining any per-connection state, enabling the receiver to operate completely independently from the sender.

Sharding for multi-core address generation parallelization represents another algorithmic innovation. For n shards, starting addresses are distributed as a₀, a₁, ..., a(n-1) = a₀·g⁰⁻⁽ⁿ⁻¹⁾, and each shard iterates using g^n instead of g, effectively "skipping forward" by n elements each iteration with the formula a(i+1) = a(i) · g^n mod p. This eliminates mutex locks entirely, as each thread maintains only three integers (starting address, end address, current address) and operates completely independently. The sharding optimization proved essential for 10 gigabit performance, improving throughput by 68% from 1.07 Gbps to 1.80 Gbps by parallelizing the expensive modulo operation across multiple CPU cores.

Constraint tree optimization enables efficient blacklist processing without performance penalties. The hybrid data structure combines a radix tree modeling the IPv4 space as a binary tree (each node representing a network prefix, leaves colored white for allowed or black for blocked) with an array storing entirely-allowed /20 prefixes for fast-path lookups. The /20 size was empirically determined as the optimal trade-off between lookup speed and memory usage. Each tree node maintains a count of allowed addresses in its subtree, enabling efficient mapping from permutation index i to the ith allowed address through recursive O(log n) procedures. This supports complex blacklists with 1,000+ entries without impacting scan rates at 14+ million packets per second.

## Practical applications from certificate ecosystem analysis to vulnerability tracking

ZMap revolutionized **TLS certificate ecosystem studies**, enabling comprehensive surveys previously impossible due to time constraints. One year of monitoring (158 Internet-wide scans) collected 33.6 million unique X.509 certificates from port 443, identifying 1,832 browser-trusted signing certificates from 683 organizations and discovering critical security issues including misissued CA certificates from a Turkish transit provider and 1,300 misissued Korean government certificates. The study tracked HTTPS adoption showing 23% increase among Alexa Top 1 Million sites, 10.9% increase in browser-trusted certificates, and 19.6% growth in HTTPS-serving hosts. Compared to previous approaches, ZMap methodology proved 650 times faster than the 2010 EFF SSL Observatory (3 months on 3 machines) and 65 times faster than Heninger's 2012 study (25 hours with 25 EC2 instances costing $300).

Weak cryptographic key detection demonstrates ZMap's value for proactive security monitoring. Scans identified **44,600 certificates with factorable RSA keys** (affecting 51,000 hosts, a 20% decrease from 2011) and **2,743 certificates with Debian weak keys** (34% decrease), with automated alerts triggering when new browser-trusted certificates appeared with known weaknesses. This continuous monitoring enabled tracking of mitigation efforts following vulnerability disclosures, measuring how quickly organizations patched systems and replaced compromised certificates. The Heartbleed vulnerability response showcased ZMap's critical role, with comprehensive scans completed every few hours after disclosure enabling defensive monitoring that outpaced attackers who began scanning within 22 hours of public announcement.

Network infrastructure monitoring enabled novel applications like **Hurricane Sandy impact assessment** in 2012. Continuous scans during the storm tracked responsive hosts, identifying power outages through geographical mapping of regions showing greater than 30% decrease in listening hosts. This near real-time infrastructure assessment provided information unavailable through traditional means, demonstrating ZMap's capability for time-critical measurement with temporal resolution impossible using slower scanners. Protocol adoption studies scanned random 0.05% samples across TCP ports 0-9175, discovering top services (HTTP 1.77%, CWMP 1.12%, HTTPS 0.93%) and identifying unexpected embedded device ports like 7547 (CWMP) and 3479 (2Wire RPC).

Vulnerability assessment at Internet scale became routine. **UPnP vulnerability discovery** completed in under 2 hours, finding 15.7 million publicly accessible UPnP devices with 3.4 million vulnerable systems (2.56 million Intel SDK, 817,000 MiniUPnPd), demonstrating that all vulnerable devices could theoretically be infected with a single UDP packet in hours. Tor bridge discovery achieved 79-86% enumeration of allocated bridges through scans of ports 443 and 9001 combined with TLS handshake heuristics and certificate pattern matching (CN=www.X.com format), revealing limitations of security through obscurity and informing obfsproxy randomized port defenses.

Integration workflows combine ZMap with complementary tools in the ZMap Project ecosystem. The standard **ZMap + ZGrab2 pipeline** performs Layer 4 discovery followed by application-layer interrogation: `zmap -p 443 | ztee results.csv | zgrab2 http` where ZTee buffers and splits output for parallel processing. ZGrab2 supports HTTP, HTTPS, SSH, Telnet, FTP, SMTP, POP3, IMAP, Modbus, BACNET, Siemens S7, and Tridium Fox protocols, outputting detailed handshake transcripts and certificate data. Additional ecosystem tools include ZDNS for fast recursive DNS lookups, ZAnnotate for GeoIP2/routing/WHOIS enrichment, ZTag for transforming raw handshakes into descriptive device records (powering Censys), LZR for 99% accurate protocol identification in 5 handshakes, and ZCrypto/ZLint for X.509 certificate parsing and validation against RFC and CA/Browser Forum requirements.

## Production deployment powers continuous Internet measurement and security services

**Censys**, the public search engine built on ZMap infrastructure, demonstrates production-scale deployment capabilities. As of 2024, the platform completes full IPv4 scans every day in approximately 4 hours (down from over 1 day in 2014), processing 4.3 billion IPv4 addresses daily through ZMap network-layer scanning, ZGrab application-layer data collection, ZTag annotation, and comprehensive indexing. The service maintains searchable historical data enabling researchers to query Internet-wide information without running their own scans, and has powered over 500 academic papers. More than 50% of Fortune 500 companies use Censys for attack surface management, with 33% of all IPv4 scan traffic fingerprinted as ZMap-based as of 2024, primarily originating from Google Cloud where security companies operate scanning infrastructure.

Commercial adoption spawned an entire **attack surface management industry**. Over a dozen security companies built products on ZMap, including Palo Alto Networks (Xpanse acquisition), BitSight, FICO, BinaryEdge, ShadowServer, and IPInfo. These platforms provide continuous monitoring of Internet-facing assets, real-time vulnerability detection, emerging threat identification, and third-party risk assessment for supply chain security. Over 40 national intelligence and defense agencies utilize ZMap-based services, alongside widespread enterprise security operations center integration for threat intelligence, incident response, and proactive defense. The security ratings industry in particular relies on ZMap's ability to enumerate exposed services for evaluating organizational security postures.

Academic deployment established scanning best practices and ethical frameworks. The **University of Michigan setup** used HP ProLiant DL120 G7 with Xeon E3-1230 3.2 GHz processor and 4GB RAM connected to standard gigabit office network, conducting over 200 Internet-wide scans during the first year of development (2012-2013) from researchscanx.eecs.umich.edu. The team documented 145 email responses over one year: 41 from small/medium businesses, 38 from home users, 22 from academic institutions, 17 from corporations, 15 from government/military, and 2 from ISPs, ultimately excluding 91 networks totaling 3.75 million addresses. This operational experience informed best practice documentation emphasizing coordination with network administrators, clear identification via reverse DNS and websites, simple opt-out mechanisms, and spreading traffic across time and addresses.

Distributed scanning patterns enable massive scale through sharding. Multi-machine deployments divide address space with consistent seeds: `zmap --shards 3 --shard 0 --seed 1234 -B 500M` on machine 1, `--shard 1` on machine 2, `--shard 2` on machine 3, each handling one-third of the address space independently. This approach scales beyond single machine bandwidth limits, enables geographic distribution for improved coverage, and provides fault tolerance through redundancy. Cloud-based deployments use Docker containers (`docker run --rm -i ghcr.io/zmap/zgrab2 http < targets.txt`) with configuration management for reproducible scanning infrastructure, often deployed on AWS EC2 or Google Cloud with 10 gigabit instances.

Penetration testing workflows leverage ZMap's speed for authorized assessments. The recommended multi-phase approach uses **ZMap for initial discovery** (fast identification of live hosts and services), **Masscan or Unicornscan for intermediate enumeration** (broader port scanning), **Nmap for deep analysis** (comprehensive service detection and vulnerability scanning), and **ZGrab/manual testing for application-layer assessment**. ZMap generates significant traffic and is not stealthy, making it better suited for authorized testing with appropriate rate limiting (typically 10,000 pps for safe LAN scanning, 10 Mbps for conservative Internet scanning, and full line rate only with well-provisioned infrastructure and coordination).

## Design strengths enable unprecedented capabilities with necessary trade-offs

ZMap's **technical superiorities** stem from architectural decisions optimizing for horizontal Internet-wide scanning. The stateless design eliminates per-connection memory overhead, enabling scanning of billions of addresses with minimal footprint (~500MB for full deduplication across single port, or negligible memory with window deduplication). Asynchronous send/receive threading with minimal shared state removes synchronization bottlenecks, allowing independent operation at maximum NIC capacity. Direct Ethernet frame generation via raw sockets bypasses kernel TCP/IP stack overhead, eliminating routing lookups, ARP cache checks, and netfilter processing that limit per-packet performance. The cyclic multiplicative group approach provides cryptographically sound randomization with only three integers stored per shard, ensuring statistical validity for sampling while preventing network saturation.

Modular architecture provides extensibility through clean interfaces. **Probe modules** implement small callback sets for different scan types (TCP SYN, ICMP echo, UDP with payload templating, NTP, DNS, UPnP, BACNET), with users adding custom types by filling static packet content, updating host-specific values, receiving packets after validation, determining positive vs. negative responses, and validating integrity. **Output modules** handle event-driven processing with callbacks for initialization, packet sent, response received, progress updates, and termination, supporting CSV, JSON, Redis queuing, database integration, and custom follow-up handshakes via forge_socket kernel module. This separation of concerns enables researchers to focus on scan-specific logic while leveraging ZMap's optimized core.

Performance optimizations achieve 97-98% of theoretical network capacity. Packet caching pre-generates static content once, updating only host-specific fields per probe. Core binding prevents OS thread migration, reducing cache misses and context switch overhead. PF_RING Zero Copy for 10 gigabit eliminates kernel involvement entirely, providing direct userspace-to-NIC communication without memory copies or context switches. Address generation sharding parallelizes expensive modulo operations across CPU cores without mutex locks, improving throughput 68%. The constraint tree with /20 array fast-path enables complex blacklist processing at 14+ Mpps without performance impact. Every operation was scrutinized given only 200 CPU cycles per probe at 3 GHz and L2 cache misses costing ~100 cycles.

**Inherent limitations** balance these strengths. Single-probe methodology accepts 2% packet loss as reasonable trade-off for speed, unsuitable for applications requiring perfect coverage. Layer 4 liveness does not guarantee Layer 7 service presence, creating discrepancies requiring two-phase scanning with tools like ZGrab or LZR to identify actual services. IPv4-only design cannot brute-force IPv6's 2¹²⁸ address space, requiring separate methodologies like ZMapv6 or 6Scan using target generation algorithms. Port scanning optimization favors single-port surveys, with multi-port scanning added later but still less efficient than Masscan for scanning many ports across large networks.

Network safety requires careful configuration. ZMap can overwhelm networks if misconfigured, making rate limiting essential via `-B` bandwidth flags or `-r` packet rate limits. Recommended conservative rate is 10,000 pps for general Internet scanning, increasing gradually while monitoring for issues. Blacklist management is critical, with default `/etc/zmap/blocklist.conf` excluding RFC 1918 private addresses, multicast, and IANA reserved space, plus organizational opt-out requests requiring prompt processing. Time-of-day effects show ±3.1% hit rate variation (highest 7 AM EST, lowest 7:45 PM EST) due to diurnal patterns in host availability and network congestion. Hit rate remains stable up to 4 Mpps but degrades linearly above this due to upstream network congestion rather than ZMap limitations.

## Responsible research principles embedded in design and operation

ZMap's development aligned explicitly with **the Menlo Report** ethical framework for ICT research, applying Belmont Report principles (respect for persons, beneficence, justice, respect for law) to Internet measurement. The tool provides built-in ethical features including default blacklisting of RFC 1918 private addresses and IANA reserved space, configurable exclusion via radix trees honoring opt-out requests, and identifiable scanning through static IP ID of 54321, reverse DNS (researchscanx.eecs.umich.edu), websites on source addresses explaining purpose, and clear contact information for complaints. Traffic distribution through random address permutation ensures minimal impact, with each /24 network receiving packets only every 10.6 seconds at full gigabit speed, far below saturation thresholds.

The research team documented **comprehensive best practices** for responsible scanning that became field standards. Guidelines emphasize coordinating with local network administrators to reduce risks and handle inquiries, signaling benign nature through clear DNS entries and information websites, explaining purpose and scope in public documentation, providing simple opt-out mechanisms honoring requests within 24 hours, minimizing scan frequency and size to only what research requires, spreading traffic over multiple source addresses and time when feasible, and explicitly avoiding exploitation of vulnerabilities, accessing protected resources, or violating local legal requirements.

Operational transparency exceeded typical practices. The team published the complete scanning methodology in academic papers, released source code as open source (Apache License 2.0), maintained public documentation of exclusion processes, engaged with affected parties responding to all inquiries, and provided detailed technical information enabling replication. Over one year of operation, 145 email responses resulted in 91 network exclusions (3.75 million addresses, 0.11% of IPv4 space), with 15 actively hostile responses but only 2 retaliatory DoS attacks (blacklisted by upstream providers). This response rate and pattern informed understanding of Internet community reaction to research scanning.

Legal due diligence addressed Computer Fraud and Abuse Act (CFAA) concerns through careful scoping. The research **avoided tactics that could cause harm**: no authentication attempts, no exploitation of discovered vulnerabilities, no access to protected resources or private data, scanning only public-facing services on standard ports, and focusing on observation rather than interaction. The team consulted legal counsel, coordinated with university administration and institutional IT security, documented all scanning activities comprehensively, and responded promptly to legal inquiries. International considerations acknowledged varied legal regimes globally, with recommendations for compliance with local laws and random distribution minimizing targeting concerns.

**Known limitations** constrain applications requiring complete coverage or specific characteristics. Single-packet scanning achieves 98% coverage but misses hosts with packet filtering or delayed responses. Temporal validity challenges arise because Internet state changes constantly, making results immediately stale and requiring continuous scanning for accuracy. False negatives occur from packet loss (2% estimated), firewall/IDS blocking, rate limiting by intermediate routers, and geographic/political filtering. False positives include SYN-ACKs from middleboxes rather than end hosts, honeypots, and transparent proxies. The Layer 4/Layer 7 gap means TCP liveness does not guarantee service presence, with some hosts "shunning" L4-only scanners requiring application-layer follow-up.

Ethical constraints define appropriate uses. ZMap **must not** be used for scanning private networks without permission, exploiting discovered vulnerabilities, accessing protected resources, violating local legal requirements, or causing network disruptions. Researchers **must** honor opt-out requests promptly, maintain operational transparency, respond to complaints professionally, document methodology thoroughly, and coordinate with network operators when scanning infrastructure they control. Academic use has powered 307 research papers directly based on ZMap data and 500+ using Censys, with applications spanning TLS security (38 papers), IoT security (25 papers), censorship and privacy (14 papers), and vulnerability detection across the Internet.

## Continuing evolution and expanding impact shape Internet security research

ZMap's development continues with **version 4.3.4 released May 2025**, introducing multi-port scanning capabilities (long-requested breaking change in v4.1.0), probe arguments for TCP SYN module enabling OS-specific options (Ubuntu, MacOS, Windows, minimum-size), AES hardware acceleration improving performance when CPU becomes bottleneck, libjudy library dependency for efficient multi-port state tracking, integration tests via GitHub Actions across supported platforms, and critical bug fixes including receive thread deadlock with malformed TCP options. The Apache License 2.0 codebase maintained by Phillip Stephens at Stanford University continues active development, with contributions from Zakir Durumeric (now Assistant Professor at Stanford and Censys co-founder), David Adrian, Eric Wustrow (University of Colorado Boulder), and J. Alex Halderman (University of Michigan).

The **ZMap Project ecosystem** grew to 33+ repositories providing comprehensive Internet measurement infrastructure. ZGrab2 (Go implementation) handles stateful application-layer scanning for HTTP, HTTPS, SSH, Telnet, FTP, SMTP, POP3, IMAP, Modbus, BACNET, Siemens S7, and Tridium Fox with detailed handshake transcription. ZDNS performs fast DNS lookups including A, AAAA, CAA, MX, TXT, DMARC records with recursive resolver support. LZR achieves 99% accurate protocol identification in 5 handshakes, addressing the Layer 4/Layer 7 gap. ZLint validates X.509 certificates against RFC conformity and CA/Browser Forum requirements. ZAnnotate enriches scan results with GeoIP2, routing data, reverse DNS, and WHOIS information. ZIterate produces random IPv4 permutations with network selection and sharding support. The integrated pipeline enables end-to-end workflows from discovery through analysis.

Academic impact extends beyond direct usage to **research methodology advancement**. ZMap democratized Internet measurement, reducing costs from $300-$3,000 for distributed cloud scanning to near-zero for researchers with institutional network access, and reducing timeframes from months to under an hour. Temporal resolution improvements enabled previously impossible continuous monitoring studies like Hurricane Sandy impact assessment and Heartbleed patch tracking. The tool enabled 307 papers directly using ZMap data and 500+ using Censys, appearing in 160 venues with concentration in IMC, USENIX Security, CCS, and NDSS. Nearly 100 theses incorporated ZMap-based research, training the next generation of security researchers in large-scale measurement techniques.

Industry transformation reshaped security practices and created new market categories. The **attack surface management industry** emerged directly from ZMap's capabilities, with companies providing continuous asset discovery, vulnerability exposure tracking, third-party risk assessment, and supply chain security analysis. Security ratings businesses evaluate organizational security postures through exposed service enumeration. Threat intelligence platforms leverage continuous scanning for botnet infrastructure detection, DDoS attack source identification, and reconnaissance activity tracking. Government adoption includes 40+ national intelligence and defense agencies using ZMap-based services for cybersecurity defense and threat assessment.

Research contributions continue advancing the field. The **"Ten Years of ZMap" retrospective** (IMC 2024) documented lessons learned including the critical importance of ease of use through documentation and packaging, need for library interfaces beyond CLI for automation, value of separating data/logs/metadata into multiple output streams, and benefits of community engagement through open source development. Ongoing work addresses remaining challenges like IPv6 scanning methodologies, improved application-layer service detection, middlebox interference mitigation, and enhanced coverage techniques. The community continues innovating on ZMap's foundation, with statistical sampling methodologies, distributed scanning coordination protocols, and measurement ethics frameworks all benefiting from a decade of operational experience and academic refinement.

ZMap fundamentally transformed Internet security research from a resource-intensive endeavor requiring months and substantial infrastructure into routine operations completable in under an hour from commodity hardware. The combination of novel algorithmic innovations, careful ethical design, comprehensive tooling ecosystem, and sustained community engagement established new standards for large-scale network measurement while demonstrating that fast, comprehensive Internet-wide scanning can be conducted responsibly and legally. As we transition toward IPv6 and increasingly complex network architectures, the principles and techniques pioneered by ZMap continue guiding the evolution of Internet measurement science, security research methodologies, and operational security practices worldwide.